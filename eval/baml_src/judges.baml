class Service {
  name string
  priceBRL float
}

class BusinessProfile {
  businessName string
  businessType string
  city string
  neighbourhood string
  services Service[]
  targetAudience string
  brandVibe string
  quirks string[]
}

class ContentRole {
  name string
  description string
}

class JudgeResult {
  reasoning string
  verdict bool
}

function JudgeNaturalidade(profile: BusinessProfile, content: string) -> JudgeResult {
  client JudgeClient
  prompt #"
    VocÃª Ã© um avaliador rigoroso de conteÃºdo para Instagram brasileiro.

    JÃ¡ foi verificado que o texto usa portuguÃªs brasileiro informal. Sua tarefa Ã© diferente: avaliar se o texto parece escrito por uma PESSOA REAL ou por uma IA imitando o estilo do Instagram.

    Perfil do negÃ³cio:
    - Nome: {{ profile.businessName }}
    - Tipo: {{ profile.businessType }}
    - Cidade: {{ profile.city }}
    - Bairro: {{ profile.neighbourhood }}

    ConteÃºdo a avaliar:
    ---
    {{ content }}
    ---

    Sinais de conteÃºdo gerado por IA (reprove se encontrar 2 ou mais):
    - Emoji em quase toda frase, como decoraÃ§Ã£o automÃ¡tica
    - Mesma estrutura nos posts: abertura animada â†’ informaÃ§Ã£o â†’ pergunta â†’ CTA
    - Informalidade forÃ§ada: acumula gente, bora, nÃ©, tÃ¡ no mesmo parÃ¡grafo como checklist
    - Frases genÃ©ricas de preenchimento ("feito com muito carinho", "vocÃª merece o melhor", "a gente ama o que faz")
    - Tom uniformemente entusiasmado do inÃ­cio ao fim, sem variaÃ§Ã£o de energia

    Sinais de conteÃºdo autÃªntico (aprove se predominarem):
    - Voz com personalidade prÃ³pria, nÃ£o "brasileiro genÃ©rico de Instagram"
    - Ritmo variado: mistura frases curtas e longas naturalmente
    - Emojis com intenÃ§Ã£o, nÃ£o em toda frase
    - Pelo menos um momento que soa como opiniÃ£o pessoal, nÃ£o fÃ³rmula

    Exemplo de reprovaÃ§Ã£o (deve receber verdict: false):
    "Gente, vocÃªs nÃ£o tÃ£o prontos! ğŸ˜ğŸ”¥ Nosso smash Ã© feito com muito amor e dedicaÃ§Ã£o pra vocÃªs! A gente ama o que faz e isso faz toda a diferenÃ§a, nÃ©? ğŸ’• Cada detalhe Ã© pensado com carinho pra vocÃªs! Bora experimentar? Chama no WhatsApp! ğŸ˜˜"
    Motivo: emoji em toda frase, "feito com amor e dedicaÃ§Ã£o" + "pensado com carinho" (filler genÃ©rico), gente + nÃ© + bora empilhados no mesmo parÃ¡grafo, tom 100% entusiasmado sem pausa. Parece IA performando informalidade.

    Primeiro explique seu raciocÃ­nio em 2-3 frases, depois dÃª o veredito.
    Veredito: true se soa autÃªntico, false se parece gerado por IA.

    {{ ctx.output_format }}
  "#
}

function JudgeEspecificidade(profile: BusinessProfile, content: string) -> JudgeResult {
  client JudgeClient
  prompt #"
    VocÃª Ã© um avaliador rigoroso de conteÃºdo para Instagram brasileiro.

    JÃ¡ foi verificado que o texto menciona o nome do negÃ³cio e a localizaÃ§Ã£o. Sua tarefa Ã© diferente: avaliar se o conteÃºdo vai ALÃ‰M dos dados do perfil, ou se Ã© apenas os dados reformatados em tom de Instagram.

    Perfil do negÃ³cio (estes sÃ£o os dados que a IA recebeu para gerar o conteÃºdo):
    - Nome: {{ profile.businessName }}
    - Tipo: {{ profile.businessType }}
    - Cidade: {{ profile.city }}
    - Bairro: {{ profile.neighbourhood }}
    - ServiÃ§os: {% for s in profile.services %}{{ s.name }} (R${{ s.priceBRL }}){% if not loop.last %}, {% endif %}{% endfor %}
    - PÃºblico: {{ profile.targetAudience }}
    - Vibe: {{ profile.brandVibe }}
    - Diferenciais: {% for q in profile.quirks %}{{ q }}{% if not loop.last %}, {% endif %}{% endfor %}

    ConteÃºdo a avaliar:
    ---
    {{ content }}
    ---

    Compare o conteÃºdo com os dados do perfil acima. Cada fato no conteÃºdo veio de um campo do perfil, ou existe pelo menos um detalhe inventado criativamente?

    Reprove se:
    - Toda informaÃ§Ã£o no conteÃºdo Ã© rastreÃ¡vel a um campo do perfil acima
    - O conteÃºdo Ã© o perfil reescrito em tom casual, sem adicionar nada
    - NÃ£o hÃ¡ nenhuma cena, momento, anedota ou detalhe alÃ©m dos dados

    Aprove se:
    - Pelo menos um detalhe concreto que nÃ£o estÃ¡ no perfil (uma cena do dia a dia, uma observaÃ§Ã£o sobre o bairro, um hÃ¡bito dos clientes, um momento especÃ­fico)
    - O conteÃºdo conta uma micro-histÃ³ria ou pinta um cenÃ¡rio, nÃ£o apenas lista atributos

    Exemplo de reprovaÃ§Ã£o (dados do perfil reformatados):
    "Aqui no Setor Bueno a gente faz smash burger com nosso blend secreto ğŸ” O molho da casa Ã© preparado todo dia! Simples por R$28, duplo por R$38, combo completo por R$52. Bora provar?"
    Motivo: Setor Bueno = campo bairro, blend secreto = campo diferenciais, molho da casa = campo diferenciais, preÃ§os = campo serviÃ§os. Cada informaÃ§Ã£o veio do perfil. Zero textura, zero cenas.

    Exemplo de aprovaÃ§Ã£o:
    "Sexta 18h e o cheiro da chapa jÃ¡ tÃ¡ chamando a galera aqui no Bueno ğŸ”¥ Tem fila? Tem. Mas quem jÃ¡ mordeu o duplo sabe que vale cada minuto. Hoje o Rafa tÃ¡ no comando da chapa, capricho dobrado ğŸ˜‚"
    Motivo: "sexta 18h" (cena temporal), "cheiro da chapa" (sensorial), "tem fila" (observaÃ§Ã£o real), "Rafa no comando" (personagem). Detalhes que dÃ£o vida e nÃ£o estÃ£o nos dados do perfil.

    Primeiro explique seu raciocÃ­nio em 2-3 frases, depois dÃª o veredito.
    Veredito: true se vai alÃ©m dos dados, false se Ã© perfil reformatado.

    {{ ctx.output_format }}
  "#
}

function JudgeAcionavel(profile: BusinessProfile, content: string) -> JudgeResult {
  client JudgeClient
  prompt #"
    VocÃª Ã© um avaliador rigoroso de conteÃºdo para Instagram brasileiro.

    JÃ¡ foi verificado que o texto tem legenda, hashtags, CTA e nota de produÃ§Ã£o. Sua tarefa Ã© diferente: avaliar a QUALIDADE desses elementos.

    Perfil do negÃ³cio:
    - Nome: {{ profile.businessName }}
    - Tipo: {{ profile.businessType }}

    ConteÃºdo a avaliar:
    ---
    {{ content }}
    ---

    Avalie estes 4 critÃ©rios de qualidade:

    HASHTAGS: reprove se a maioria for genÃ©rica (#sucesso #empreendedorismo #foco #motivaÃ§Ã£o #trabalho #pequenonegocio #apoielocal). Aprove se forem especÃ­ficas do nicho, do bairro ou do negÃ³cio.

    NOTA DE PRODUÃ‡ÃƒO: reprove se for vaga ("tire uma foto do produto", "grave um vÃ­deo mostrando o serviÃ§o"). Aprove se disser o que filmar, de que Ã¢ngulo, em que momento.

    CTA: reprove se for o mesmo CTA copiado em todos os posts. Aprove se variar entre posts.

    FLUIDEZ: reprove se a legenda parecer seÃ§Ãµes coladas (texto â†’ bloco de hashtags â†’ CTA solto â†’ nota solta). Aprove se a transiÃ§Ã£o entre elementos for natural.

    Reprove se 2 ou mais critÃ©rios falharem.

    Exemplo de reprovaÃ§Ã£o (elementos existem mas sem qualidade):
    Post 1: "... Chama no WhatsApp! #empreendedorismo #sucesso #foco #negociolocal #motivaÃ§Ã£o. Nota de produÃ§Ã£o: tire uma foto bonita do produto."
    Post 2: "... Chama no WhatsApp! #empreendedorismo #sucesso #negociolocal #trabalho #foco. Nota de produÃ§Ã£o: grave um vÃ­deo do serviÃ§o."
    Motivo: hashtags genÃ©ricas repetidas, mesmo CTA em ambos, notas de produÃ§Ã£o vagas. Tudo existe estruturalmente mas nada tem qualidade.

    Primeiro explique seu raciocÃ­nio em 2-3 frases, depois dÃª o veredito.
    Veredito: true se os elementos tÃªm qualidade, false se sÃ£o genÃ©ricos/repetitivos.

    {{ ctx.output_format }}
  "#
}

function JudgeVariedade(profile: BusinessProfile, content: string) -> JudgeResult {
  client JudgeClient
  prompt #"
    VocÃª Ã© um avaliador rigoroso de conteÃºdo para Instagram brasileiro.

    Analise se os posts sÃ£o genuinamente diferentes ou se sÃ£o o mesmo template com temas trocados.

    Perfil do negÃ³cio:
    - Nome: {{ profile.businessName }}
    - Tipo: {{ profile.businessType }}

    ConteÃºdo a avaliar:
    ---
    {{ content }}
    ---

    NÃ£o basta os posts terem temas diferentes. Eles precisam ter:
    - Estruturas diferentes (um narrativo, outro lista, outro pergunta/resposta)
    - Aberturas com ritmos diferentes (nÃ£o todos com emoji + frase de efeito)
    - Tons diferentes (um animado, outro informativo, outro Ã­ntimo)
    - CTAs diferentes (nÃ£o todos terminam com "chama no WhatsApp")

    Teste do template: pegue a estrutura de um post e troque o tema. Se funcionar sem alterar nada, os posts sÃ£o o mesmo template.

    Reprove se:
    - Todos seguem o padrÃ£o: [abertura animada] â†’ [info sobre serviÃ§o] â†’ [pergunta ao pÃºblico] â†’ [CTA] â†’ [hashtags]
    - As aberturas tÃªm o mesmo ritmo/energia mesmo com palavras diferentes
    - Troque os temas entre posts e a estrutura ainda funciona

    Aprove se:
    - Pelo menos 2 posts tÃªm estruturas claramente diferentes (ex: um Ã© lista numerada, outro Ã© narrativa, outro comeÃ§a com pergunta provocativa)
    - A energia varia entre posts (nÃ£o sÃ£o todos no mesmo nÃ­vel de entusiasmo)

    Exemplo de reprovaÃ§Ã£o (template com temas trocados):
    Post 1: "Gente, vocÃªs sabiam que [corte X] Ã© sucesso? ğŸ˜ Aqui no salÃ£o a gente faz com carinho! Qual Ã© o seu favorito? Comenta! ğŸ’‡â€â™€ï¸ Chama no WhatsApp!"
    Post 2: "Gente, olha que incrÃ­vel essa [coloraÃ§Ã£o Y]! ğŸ”¥ Aqui no salÃ£o a gente arrasa! JÃ¡ experimentou? Conta pra gente! ğŸ’• Chama no WhatsApp!"
    Post 3: "Gente, prepara o coraÃ§Ã£o pra [tratamento Z]! âœ¨ Aqui no salÃ£o a gente cuida de tudo! O que vocÃªs acham? Comenta aqui! ğŸ’†â€â™€ï¸ Chama no WhatsApp!"
    Motivo: todos abrem com "Gente" + emoji, mesma estrutura (fato â†’ serviÃ§o â†’ pergunta â†’ CTA), mesmo tom, mesmo CTA. Temas mudaram, template nÃ£o.

    Se houver apenas um post, avalie se demonstra criatividade e nÃ£o segue um template Ã³bvio.

    Primeiro explique seu raciocÃ­nio em 2-3 frases, depois dÃª o veredito.
    Veredito: true se hÃ¡ variedade real, false se Ã© template com temas trocados.

    {{ ctx.output_format }}
  "#
}

function JudgeEngajamento(profile: BusinessProfile, content: string) -> JudgeResult {
  client JudgeClient
  prompt #"
    VocÃª Ã© um avaliador rigoroso de conteÃºdo para Instagram brasileiro.

    JÃ¡ foi verificado que o texto tem CTA e convite Ã  interaÃ§Ã£o. Sua tarefa Ã© diferente: avaliar se o gancho Ã© GENUINAMENTE interessante ou apenas uma fÃ³rmula de engajamento.

    Perfil do negÃ³cio:
    - Nome: {{ profile.businessName }}
    - Tipo: {{ profile.businessType }}
    - PÃºblico: {{ profile.targetAudience }}

    ConteÃºdo a avaliar:
    ---
    {{ content }}
    ---

    Reprove se:
    - O gancho usa fÃ³rmulas batidas: "VocÃª sabia que...?", "Gente, prepara o coraÃ§Ã£o!", "VocÃªs nÃ£o estÃ£o prontos!", "[NÃºmero] coisas que..."
    - O engajamento depende de pedir aÃ§Ã£o genÃ©rica ("comenta aqui ğŸ‘‡", "marca um amigo") sem dar motivo real para fazÃª-lo
    - O conteÃºdo descreve o serviÃ§o de forma positiva mas sem Ã¢ngulo surpreendente
    - Qualquer negÃ³cio do mesmo tipo poderia usar o mesmo gancho

    Aprove se:
    - A primeira linha cria curiosidade real (um dado especÃ­fico, uma cena, uma contradiÃ§Ã£o, uma histÃ³ria que comeÃ§a no meio)
    - HÃ¡ motivo real pra salvar, compartilhar ou comentar (aprendi algo novo, me identifiquei com a situaÃ§Ã£o, quero mandar pra alguÃ©m especÃ­fico)
    - O gancho sÃ³ funciona para este negÃ³cio, nÃ£o Ã© genÃ©rico do nicho

    Exemplo de reprovaÃ§Ã£o (fÃ³rmula de engajamento):
    "VocÃª sabia que um bom corte pode mudar completamente seu visual? ğŸ˜± Pois Ã©! Aqui no nosso espaÃ§o a gente transforma! Antes e depois que vai te deixar de queixo caÃ­do! Comenta aqui se vocÃª tambÃ©m ama! ğŸ‘‡ Marca aquele amigo que tÃ¡ precisando! ğŸ˜‚"
    Motivo: "VocÃª sabia" (gancho genÃ©rico), "mudar completamente seu visual" (Ã³bvio, qualquer salÃ£o diria isso), "comenta + marca" sem dar motivo real. FÃ³rmula, nÃ£o engajamento.

    Primeiro explique seu raciocÃ­nio em 2-3 frases, depois dÃª o veredito.
    Veredito: true se o engajamento Ã© genuÃ­no, false se Ã© fÃ³rmula.

    {{ ctx.output_format }}
  "#
}
